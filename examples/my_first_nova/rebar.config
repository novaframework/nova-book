%% -*- mode: erlang;erlang-indent-level: 4;indent-tabs-mode: nil -*-

{erl_opts, [debug_info]}.
{src_dirs, [{"src", [{recursive, true}]}]}.
{shell, [{config, "./config/dev_sys.config.src"}]}.

{erlydtl_opts, [
    {doc_root, "src/views"},
    {recursive, true},
    {libraries, [
        {nova_erlydtl_inventory, nova_erlydtl_inventory}
    ]},
    {default_libraries, [nova_erlydtl_inventory]}
]}.

{deps, [
    nova,
    %% Used for logging - Change if needed
    {flatlog, "0.1.2"},
    {kura, "~> 0.3"}
]}.

%% Release profiles
%% To create a release just run
%% rebar3 as prod release
{relx, [
    {release, {my_first_nova, git}, [
        my_first_nova,
        sasl
    ]},
    {mode, dev},
    {sys_config_src, "./config/dev_sys.config.src"},
    {vm_args_src, "./config/vm.args.src"}
]}.

{profiles, [
    {prod, [
        {relx, [
            {mode, prod},
            {sys_config_src, "./config/prod_sys.config.src"}
        ]}
    ]},
    {test, [
        {deps, [meck, nova_test]},
        {ct_opts, [{sys_config, ["config/test_sys.config"]}]}
    ]}
]}.

%% Plugins for rebar3
{plugins, [
    {rebar3_erlydtl_plugin, ".*",
        {git, "https://github.com/tsloughter/rebar3_erlydtl_plugin.git", {branch, "master"}}},
    {rebar3_nova, ".*",
        {git, "https://github.com/novaframework/rebar3_nova.git", {branch, "master"}}}
]}.

{project_plugins, [
    {rebar3_kura, "~> 0.3"},
    erlfmt
]}.

{provider_hooks, [
    {pre, [
        {compile, {erlydtl, compile}},
        {compile, {kura, compile}}
    ]}
]}.
